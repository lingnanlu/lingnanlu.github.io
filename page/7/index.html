<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="keywords" content="Code, Food, Music">
<meta property="og:type" content="website">
<meta property="og:title" content="Code, Food &amp; Music">
<meta property="og:url" content="http://asanelder.me/page/7/index.html">
<meta property="og:site_name" content="Code, Food &amp; Music">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Code, Food &amp; Music">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://asanelder.me/page/7/">





  <title>Code, Food & Music</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Code, Food & Music</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://asanelder.me/2016/03/27/toast-show-in-remote-service/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="asanelder">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Code, Food & Music">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/27/toast-show-in-remote-service/" itemprop="url">toast show in remote service[TBD]</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-27T00:00:00+08:00">
                2016-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>这天在用Messenger实现RemoteService时, 有如下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessengerService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">        Toast.makeText(getApplication(), <span class="string">"binding"</span>, Toast.LENGTH_SHORT.show();</span><br><span class="line">        <span class="keyword">return</span> mMessenger.getBinder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Manifest文件中相应的部分如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">service</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">".RemoteMessager.MessengerService"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:process</span>=<span class="string">":remote"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>即, Service运行在另一个进程中.</p>
<p>当一个Activity(和Service不是同一个进程)bind该Service时, 在Activity的界面弹出了Toast.</p>
<p>于是, 有了这样一个问题?</p>
<blockquote>
<p>Toast的显示不是涉及到UI的重绘, 而UI的重绘不是需要在UI线程中, 利用Looper机制来实现么? 难道该Service所在的新进程也有这样的一个UI线程, 也有相应的Looper? 还是该Service通过了某种IPC将所要重绘的信息发回给了Activity所在的进程?</p>
</blockquote>
<p>代码中并没有显示的Service通过IPC将信息发回给Activity所在的进程, 所以我认为第3个疑问是站不住脚的.</p>
<p>难道真的是Service所在的新进程中也包含着一个UI线程?</p>
<p>首先通过代码来验证一下, 修改如上代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessengerService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">	    String thread = Thread.currentThread() + <span class="string">""</span>;</span><br><span class="line">	    String packageName = getApplication().getPackageName();</span><br><span class="line">	    String pid = Process.myPid() + <span class="string">""</span></span><br><span class="line">        Toast.makeText(getApplication(), <span class="string">"binding"</span> + thread + packageName+ pid, Toast.LENGTH_SHORT).show();</span><br><span class="line">        <span class="keyword">return</span> mMessenger.getBinder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>而在另一个进程中Activity的onCreate方法中添加如下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_activity_messenger);</span><br><span class="line">    String thread = Thread.currentThread() + <span class="string">""</span>;</span><br><span class="line">		String packageName = getApplication().getPackageName();</span><br><span class="line">		String pid = Process.myPid() + <span class="string">""</span></span><br><span class="line">    Toast.makeText(getApplication(), <span class="string">"binding"</span> + thread + packageName +pid, Toast.LENGTH_SHORT).show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过比较两个弹出的Toast来看, packageName是相同的, 而pid是不同的.</p>
<p>这说明Service与Activity虽然在不同的进程中, 但是属于同一个Application, 即可以有如下结论</p>
<blockquote>
<p>Android中的Application只是由四大组件组成, 而对于四大组件是否在同一个进程中, 则不一定</p>
</blockquote>
<p>即Android中的Application可以有多个进程.</p>
<p>好, 回到之前的问题, 看来Service所在进程真的有那么一个UI线程, 但该线程是如何生成呢?</p>
<p>参照<a href="http://lingnanlu.github.io/2016/02/28/ams" target="_blank" rel="noopener">由一个实例了解AMS机制</a>可得出以下结论.</p>
<blockquote>
<p>在新进程中启动Activity或Service时, 都是通过AMS生成一个的进程, 并在进程中运行android.app.ActivityThread.main方法, 而该方法中就准备了Looper和相应的Handler. 所以在新的进程中启动Activity和Service时, 都有一个UI线程.</p>
</blockquote>
<p>所以可以得出, Toast是真的在新的进程当中所重绘的.</p>
<p><em>注:以上解释并不正确, 参考实例代码中, 使用Messenger时获得上述结论, 使用AIDL时, 新进程的Service会报错, 没有调用 Looper.prepare(), 这个问题还没搞清</em></p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p><a href="https://github.com/lingnanlu/Android_repo/tree/master/ClientServerDemo" target="_blank" rel="noopener">https://github.com/lingnanlu/Android_repo/tree/master/ClientServerDemo</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://asanelder.me/2016/03/27/client-server-model-using-service/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="asanelder">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Code, Food & Music">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/27/client-server-model-using-service/" itemprop="url">Service实现客户端-服务器模型的三种方式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-27T00:00:00+08:00">
                2016-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="方式一-Extending-the-Binder-class"><a href="#方式一-Extending-the-Binder-class" class="headerlink" title="方式一: Extending the Binder class"></a>方式一: Extending the Binder class</h3><p>这种方式也叫做Local Service, 因为该Service与客户端运行在同一个进程当中(可能不是同一线程), 所以只有本应用内的客户端可以使用该Service</p>
<p><strong>适用情况:</strong></p>
<p>如一个音乐App, 利用一个Service在Background播放音乐, 一个Activity与该Service绑定来控制音乐的播放与暂停.</p>
<p><strong>可传输的数据类型:</strong></p>
<p>因为在同一个进程, 所以无论是简单数据还是自定义的类, 都不需要Parcelable</p>
<h3 id="方式二-Using-A-Messenger"><a href="#方式二-Using-A-Messenger" class="headerlink" title="方式二: Using A Messenger"></a>方式二: Using A Messenger</h3><p>这是最简单的方式来实现IPC, 客户端与服务端运行在不同的进程当中, 而且服务端得到的请求是进行了排队, 所以编写服务端时不需要进行线程安全的处理.</p>
<p>其实上, 查看Messenger的源码, Messenger只是对AIDL进行了一个封装, 关于Messenger的实现, 参考以下文章</p>
<p><a href="http://blog.csdn.net/yanbober/article/details/48373341" target="_blank" rel="noopener">Android应用进程间通信之Messenger信使使用及源码浅析</a></p>
<p><strong>可传输的数据类型:</strong></p>
<p>对于简单数据可以传输, 对于自定义的类, 因为是跨进程通信, 需要为Parcelable类型.</p>
<p>因为是用Message来传输, 典型用法如下:</p>
<pre><code>Message msg = Message.obtain(null, MessengerService.MSG_SAY_HELLO, 0, 0);
Bundle bundle = new Bundle();
bundle.putParcelable(&quot;Test&quot;, new Person(&quot;kobe&quot;, &quot;bryant&quot;));
msg.setData(bundle);
mService.send(msg);
</code></pre><h3 id="方式三-Using-AIDL"><a href="#方式三-Using-AIDL" class="headerlink" title="方式三: Using AIDL"></a>方式三: Using AIDL</h3><p>最灵活与最复杂的方式, Messenger的底层实现, 需要自己来处理服务端的线程安全.一般很少用.</p>
<p><strong>可传输的数据类型:</strong></p>
<p>对于简单数据可以传输, 对于自定义的类, 因为是跨进程通信, 需要Parcelable.</p>
<h3 id="补充知识点-Parcelable-VS-Serializable"><a href="#补充知识点-Parcelable-VS-Serializable" class="headerlink" title="补充知识点 Parcelable VS Serializable"></a>补充知识点 Parcelable VS Serializable</h3><p>两者的目的不同, Serializable是为持久化, 可以写到外存, 数据库, 网络等.</p>
<p>Parcelable是为了在不同进程中传输对象, 不是为了持久化, 只发生在内存中.</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ol>
<li><a href="http://stackvoid.com/Parcelable-in-Android/" target="_blank" rel="noopener">Android序列化：Parcelable VS Serializable</a></li>
<li><a href="http://blog.csdn.net/yanbober/article/details/48373341" target="_blank" rel="noopener">Android应用进程间通信之Messenger信使使用及源码浅析</a></li>
<li><a href="http://developer.android.com/guide/components/bound-services.html" target="_blank" rel="noopener">Bound Services</a></li>
</ol>
<h3 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h3><p><a href="https://github.com/lingnanlu/Android_repo/tree/master/ClientServerDemo" target="_blank" rel="noopener">https://github.com/lingnanlu/Android_repo/tree/master/ClientServerDemo</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://asanelder.me/2016/03/26/how-to-use-sqlite-correctly/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="asanelder">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Code, Food & Music">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/26/how-to-use-sqlite-correctly/" itemprop="url">使用sqlite需要主要关注的两个方面</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-26T00:00:00+08:00">
                2016-03-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一-数据的CRUD操作以及相应的抽象"><a href="#一-数据的CRUD操作以及相应的抽象" class="headerlink" title="一 数据的CRUD操作以及相应的抽象"></a>一 数据的CRUD操作以及相应的抽象</h2><p>目的, 使使用者使用起来更方便, 不容易出错, 所以需要封装一些细节的,容易出错的东西</p>
<p>为了达到以上目的, 一般会设计如下几个类</p>
<ol>
<li>Contract类</li>
<li>SQLiteOpenHelper类</li>
<li>SQLiteDatabase类</li>
<li>封装SQL语句的类</li>
</ol>
<p>以下说明这三种类的存在必要性, 所扮演的角色, 以及三者之间的关系</p>
<h4 id="1-SQLiteOpenHelper"><a href="#1-SQLiteOpenHelper" class="headerlink" title="1. SQLiteOpenHelper"></a>1. SQLiteOpenHelper</h4><p>这是一个helper类, 主要是<strong>帮助数据库的创建</strong>和<strong>管理数据库的版本</strong>, 至于什么是数据库的版本, 下面会说明.</p>
<p>一般这个类的用法如下</p>
<pre><code>public class CustomDBHelper extends SQLiteOpenHelper() {

    public void onCreate(SQLiteDatabase db) {
        // 利用db创建相应的表
    }

    public void onUpgrade(SQliteDatabase db, int oldVersion, int newVersion){
        //更新数据库版本时所做操作
    }
}

//以下是客户端代码
SQLiteDatabase db = new CustomDBHelper().getReadableDatabase();
</code></pre><p>一个数据库对应于一个SQLiteOpenHelper, 该类负责该数据库中所有表的创建与版本管理,该类的一个对象也关联着一个SQLiteDatabase对象, 而SQLiteDatabase负责执行具体的SQL语句.</p>
<h4 id="2-SQLiteDatabase"><a href="#2-SQLiteDatabase" class="headerlink" title="2. SQLiteDatabase"></a>2. SQLiteDatabase</h4><p>该类负责执行具体的SQL语句, 和CRUD操作.由SQLiteOpenHelper得到该对象后, 这样使用:</p>
<pre><code>//执行SQL语句
db.execSQL(String sql)

//CRUD
db.delete(String table, String whereClause, String[] whereArgs)
db.insert(String table, String nullColumnHack, ContentValues values)
db.query()
db.update(String table, ContentValues values, String whereClause, String[] whereArgs)

//其它常用
db.beginTransaction()
db.endTransaction()
</code></pre><h4 id="3-封装SQL语句的类"><a href="#3-封装SQL语句的类" class="headerlink" title="3. 封装SQL语句的类"></a>3. 封装SQL语句的类</h4><p>在程序中, 如果直接使用SQL语句来做CRUD操作, 有如下弊端</p>
<ol>
<li><strong>很不方便</strong>, 每次操作都需要写很大的SQL语句</li>
<li><strong>容易出错</strong>, SQL语句就是一个字符串, 格式很严格, 少一个空格, 多一个符号都不行, 如果多处使用, 就存在多处出错的可能性</li>
<li><strong>不够直观</strong>, 因为使用数据库操作时, 往往有一个实体对象与之对应, 直接使用SQL语句操作实体对象并不直观</li>
</ol>
<p>可以通过对实体的常用操作封装一个类, 将真实的SQL语句放在类接口的实现中, 这样, 就可以一定程度上缓解以上问题.</p>
<p>但还是有一点问题, 需要为每一个实体封装一个类, 而该类的接口往往都是相似的, 违反了DRY原则, 所以更好的解决方案是使用ORM.</p>
<h4 id="4-Contract类"><a href="#4-Contract类" class="headerlink" title="4. Contract类"></a>4. Contract类</h4><p>该类并非必要, 只是提倡有这样一个类, 为的是程序的<strong>易读性</strong>和<strong>不容易出错</strong>.<br>往往一个数据库对应一个Contract类, 数据库中的一个表对应该类的一个静态内部类, 以Google官方的例子来说.</p>
<pre><code>public final class FeedReaderContract {

    //每一个表
    public static final class FeedEntry implements BaseColumns {

        //该Table的描述
        public static final String TABLE_NAME = &quot;entry&quot;;
        public static final String COLUMN_ENTRY_ID = &quot;entryid&quot;;
        public static final String COLUMN_TITLE = &quot;title&quot;;
        public static final String COLUMN_CONTENT = &quot;content&quot;;
        public static final String COLUMN_NULLABLE = &quot;&quot;;

        public static final String SQL_DELETE_ENTRIES =
            &quot;drop table if exists &quot; + TABLE_NAME;

    }

}
</code></pre><p>为一些SQL字段与语句定义一些常量, 在程序中使用常量而不直接使用对应的字符串, 可以使其更易读和不易出错.</p>
<h2 id="二-数据库的版本管理"><a href="#二-数据库的版本管理" class="headerlink" title="二 数据库的版本管理"></a>二 数据库的版本管理</h2><h3 id="数据库的版本指的是什么"><a href="#数据库的版本指的是什么" class="headerlink" title="数据库的版本指的是什么?"></a>数据库的版本指的是什么?</h3><p>假如当前有一个数据库, 库中有一个表, 将当前数据库的状态当做版本0</p>
<p>如果后来将该表的schema更改了, 此时可以认为数据库的版本改变了, 成为一个新的版本.</p>
<h3 id="什么是数据库的版本管理"><a href="#什么是数据库的版本管理" class="headerlink" title="什么是数据库的版本管理"></a>什么是数据库的版本管理</h3><p>数据库的版本管理是指,当数据库的schema更改时.</p>
<ol>
<li>如何将之前的schema改变为新的schema</li>
<li>如何将之前的数据Migrate到新的表中</li>
</ol>
<h3 id="关于版本管理的两个方法"><a href="#关于版本管理的两个方法" class="headerlink" title="关于版本管理的两个方法"></a>关于版本管理的两个方法</h3><pre><code>public abstract class SQLiteOpenHelper {

    public abstract void onCreate(SQLiteDatabase db);
    public abstract void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion);

}
</code></pre><p>基中, onCreate是在数据库第一次创建时调用的. 而onUpgrade是数据库的版本号不同时进行调用的, 而数据库的版本号是在创建SQLiteOpenHelper的对象时, 传入到构造函数中, 并且保存在数据库中的.该函数中的实现需要做到不同版本间数据的migration</p>
<h3 id="一个实例"><a href="#一个实例" class="headerlink" title="一个实例"></a>一个实例</h3><p>2013年4月，我们第一次发布了我们的应用，数据库版本是1。</p>
<p>2013年5月，我们第二次发布了我们的应用，数据库版本是2。由于业务需要，我们更改了数据库里的某个表的表结构。</p>
<p>这时候就有这样的难题出现：</p>
<p>有些用户已经下载了4月份的版本1，并且已经使用了，很多数据存储在数据库了，这个时候，他想安装新的版本2，怎么办？ 怎么才能让数据不丢失？</p>
<p>这个时候就需要使用onUpgrade的方法了.</p>
<h3 id="开发过程中表的schema需要改变怎么办"><a href="#开发过程中表的schema需要改变怎么办" class="headerlink" title="开发过程中表的schema需要改变怎么办?"></a>开发过程中表的schema需要改变怎么办?</h3><p>开发过程中表的schema也可能是经常变的, 怎么去做版本的管理?</p>
<p>有如下两种方法</p>
<ol>
<li>手动删除db文件, 这样每次运行时, 会创建新的db文件</li>
<li>每更新一次schema就改变一次版本, 并在onUpgrade中删除旧表, 重新创建新表</li>
</ol>
<p>表中的数据怎么办?</p>
<p>这个问题其实不用担心, 因为是开发过程中, 所有的数据应该是test数据, 并且是使用程序自动填充的, 所以不需要考虑数据的保留问题</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="http://stackoverflow.com/questions/21881992/when-is-sqliteopenhelper-oncreate-onupgrade-run" target="_blank" rel="noopener">When is SQLiteOpenHelper onCreate() / onUpgrade() run?</a></li>
<li><a href="http://www.cnblogs.com/vir56k/archive/2013/04/18/3028688.html" target="_blank" rel="noopener">使用SQLiteOpenHelper的onUpgrade实现数据库版本升级</a></li>
<li><a href="http://guoh.org/lifelog/2011/04/how-to-use-sqliteopenhelper/" target="_blank" rel="noopener">如何使用SQLiteOpenHelper</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://asanelder.me/2016/03/20/string-utils/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="asanelder">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Code, Food & Music">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/20/string-utils/" itemprop="url">String常用函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-20T00:00:00+08:00">
                2016-03-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="字符串形式与数值形式互转-如1-0返回”1-0”"><a href="#字符串形式与数值形式互转-如1-0返回”1-0”" class="headerlink" title="字符串形式与数值形式互转, 如1.0返回”1.0”"></a>字符串形式与数值形式互转, 如1.0返回”1.0”</h4><p>数值转字符串, 如1.0返回”1.0”</p>
<pre><code>static String valueOf(T t) // T为所有基本类型与Object
static String valueOf(char[] data)
</code></pre><p>字符串转数值, 如”1.0”转1.0</p>
<pre><code>//两者功能基本相同, 源码中valueOf就调用的parseDouble
Double.valueOf(String s)
Double.parseDouble(String s)
</code></pre><h4 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h4><pre><code>char chartAt(int index)
int compareTo(String anotherString)
int compareToIgnoreCase(String str)
String concat(String str)
boolean contains(CharSequence s)
boolean contentEquals(CharSequence cs)
boolean contentEquals(StringBuffer sb)
boolean endsWith(String suffix)
boolean startsWith(String prefix)
boolean equals(Object anObject)
boolean equalsIgnoreCase(String anotherString)
static String format(String format, Object... args)
int indexOf(int char)
int indexOf(String subString)
int lastIndexOf(int char)
int lastIndexOf(String subString)
boolean matches(String regex)
String replace(char oldChar, char newChar)
String replace(CharSequence target, CharSequence replacement)
String replaceAll(String regex, String replacement)
String replaceFirst(String regex, String replacement)
String[] split(String regex)
String[] split(String regex, int limit)
String substring(int beginIndex)
String substring(int beginIndex, int endIndex)
char[] toCharArray()
String toLowerCase()
String toUpperCase()
String trim() 忽略前导空白和末尾空白
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://asanelder.me/2016/03/20/java-regex-and-escape-character/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="asanelder">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Code, Food & Music">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/20/java-regex-and-escape-character/" itemprop="url">为什么Java正则表达式中要使用\\来进行转义?</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-20T00:00:00+08:00">
                2016-03-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先明确一个概念</p>
<h3 id="什么是转义"><a href="#什么是转义" class="headerlink" title="什么是转义?"></a>什么是转义?</h3><p>转义是一个动词,就是转换含义的意思,一个事物本来有一个含义,将之转义就是将之转换为另一个含义.</p>
<p>举个例子</p>
<p>字符t的本来含义就是字母表中的t, 而如果是\t则将t的含义转换成了制表符.这里\就是转义字符,其作用是改变其后字符的含义.而t就是被转义的字符.</p>
<p>由上可知,\出现在字符串中时,其含义就是<strong>转义字符</strong>, 如果想将之当做字面意义上的反斜线,则同样需要转义,即\\就表示一个普通意义上的反斜杠了.</p>
<p>既然知道了什么是转义,那么在Java语言中,哪些字符有另一个含义呢?也就是说哪些字符可以被转义?</p>
<h3 id="Java字符串中合法的转义"><a href="#Java字符串中合法的转义" class="headerlink" title="Java字符串中合法的转义"></a>Java字符串中合法的转义</h3><p><a href="http://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#jls-3.10.6" target="_blank" rel="noopener">Java语言规范</a>中提到</p>
<blockquote>
<p>It is a compile-time error if the character following a backslash in an escape sequence is not an ASCII  b ,  t ,  n ,  f ,  r ,  “ , ‘ ,  \ ,  0 ,  1 ,  2 ,  3 ,  4 ,  5 ,  6 , or  7 . The Unicode escape  \u is processed earlier</p>
</blockquote>
<p>所以,非以上字符的转义会导致编译错误. 即只有 b ,  t ,  n ,  f ,  r ,  “ ,  ‘,  \ ,  0 ,  1 ,  2 ,  3 ,  4 ,  5 ,  6 , or  7 可在被转义.</p>
<p>关于以上字符被转义后的含义,同样参照<a href="http://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#jls-3.10.6" target="_blank" rel="noopener">Java语言规范</a></p>
<p>那么,说了这些,和正则表达式有什么关系呢?</p>
<h3 id="为什么正则表达式中需要"><a href="#为什么正则表达式中需要" class="headerlink" title="为什么正则表达式中需要\\"></a>为什么正则表达式中需要\\</h3><p>我们知道,正则表达式中也有一些字符有双重含义,一重是其字面上的含义,另一重是其特殊含义.</p>
<p>如+, 字面含义是加号字符, 特殊含义是匹配一个或多个.如果使用转义字符\将之转换成另一个含义的话, 如下</p>
<p>\+</p>
<p>但是这样会报错, 为什么?</p>
<p>由以上Java语言规范中提到的只有 b ,  t ,  n ,  f ,  r ,  “ ,   ,  \ ,  0 ,  1 ,  2 ,  3 ,  4 ,  5 ,  6 , or  7才能被\进行转义,而+显然不在此中.</p>
<p>与此类似的情况还有很多, 如 <strong>?</strong> , <strong>.</strong> 等等.</p>
<p>那么如果能即不编译报错,又可以对这些字符进行转义呢?</p>
<p>Java定义了一个新的转义方式, 那就是\\</p>
<p>所以可以这样</p>
<p>\\+</p>
<p>而以上这种也没有违反Java语言规范中的定义,所以不会导致编译错误.</p>
<p>所以可以认为,\\是Java为了将正则表达式中的特殊字符(不包含在 b ,  t ,  n ,  f ,  r ,  “ ,   ,  \ ,  0 ,  1 ,  2 ,  3 ,  4 ,  5 ,  6 , or  7)进行转义而引进的新的转义方式.</p>
<h3 id="如果在正则表达式中使用-与"><a href="#如果在正则表达式中使用-与" class="headerlink" title="如果在正则表达式中使用\与\\"></a>如果在正则表达式中使用\与\\</h3><p>对于那些只在正则表达式中有特殊含义的字符(非b ,  t ,  n ,  f ,  r ,  “ ,   ,  \ ,  0 ,  1 ,  2 ,  3 ,  4 ,  5 ,  6 , or  7) ,使用\\,如(D,s,S,w,W, +,…..)</p>
<p>对于(b ,  t ,  n ,  f ,  r ,  “ ,   ,  \ ,  0 ,  1 ,  2 ,  3 ,  4 ,  5 ,  6 , or  7), 依然使用\</p>
<p><em>注:这里有一个特殊的字符\, 如果想将之转义为普通的反斜线,并不能直接\\, 因为这和正则表达式中定义的新的转义方式冲突了,这种情况下使用\\\\,表示正则表达式中的字面意义的反斜线. 这是一种特殊情况, 记下即可</em></p>
<p><em>再注: 还有一个特殊字符b, 使用\与\\转义后的含义不同,此时应该根据所使用的含义进行选择</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">asanelder</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">84</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lingnanlu" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/lingnanlu" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">asanelder</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
